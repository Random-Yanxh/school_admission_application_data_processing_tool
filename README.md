# 进校申请数据处理工具

## 1. 项目简介

本项目是一个使用 Python 开发的桌面应用程序，旨在帮助操作员高效处理格式不统一的《进校申请》表格数据。

该工具提供了一个简洁的图形用户界面（GUI），用户可以通过它导入原始的 `.xls` 或 `.csv` 文件，逐条对数据进行校对、修正和补充，最后将清洗干净的、标准化的数据导出为多种格式（CSV, XLSX, JSON）。

## 2. 核心功能

- **智能导入**:
    - 支持导入 `.xls`, `.xlsx`, `.csv` 多种格式的文件。
    - 能够自动识别并跳过特定格式的 CSV 文件中前置的说明性文字，直接从数据标题行开始读取。
    - 兼容 `UTF-8` 和 `GBK` 两种编码的 CSV 文件，避免乱码问题。
- **数据预处理**:
    - 导入时自动移除字段末尾的 `#` 标记，方便二次编辑。
    - 自动将车辆号码中的字母转为大写，并移除所有空格。
- **高效的UI操作**:
    - 提供“上一条”/“下一条”/“跳转”功能，方便在记录之间快速导航。
    - 对于“访问形式”、“证件类型”等字段使用下拉框，规范输入。
    - 对于“场所名称”，提供预设的校区复选框，并支持填写其他自定义场所。
- **批量填充**:
    - 针对“审批人学工号”、“审批人姓名”、“访问时间”和“事由”等字段，提供批量填充功能，可一键将输入值应用到后续所有记录，极大提升处理重复数据时的效率。
- **灵活导出**:
    - 支持将处理完成的数据导出为 `.csv`, `.xlsx`, `.json` 三种格式。
    - 导出的 CSV 文件为 `GBK` 编码，以兼容各类办公软件。
    - 导出的 CSV 文件会自动添加符合规范的12行说明头和带 `*` 的标题行。

## 3. 技术栈

- **核心语言**: Python 3
- **图形界面**: Tkinter (Python 内置)
- **数据处理**: pandas
- **日历控件**: tkcalendar

## 4. 如何运行

### 步骤 1: 安装 Python

请确保您的电脑上已经安装了 Python 3.7 或更高版本。您可以从 [Python 官网](https://www.python.org/) 下载并安装。

### 步骤 2: 安装依赖库

打开命令行工具（如 Command Prompt, PowerShell 或 Terminal），然后运行以下命令来安装本项目所需的第三方库：

```bash
pip install pandas openpyxl tkcalendar
```

### 步骤 3: 运行程序

在项目的根目录下，直接运行 `main.py` 文件即可启动程序：

```bash
python main.py
```

## 5. 使用说明

1.  **导入文件**: 点击左上角的“导入文件”按钮，选择您的原始数据文件（`.xls`, `.xlsx`, `.csv`）。
2.  **处理数据**:
    - 程序会自动加载第一条记录。
    - 在右侧的“数据编辑”区域，修正或填写每个字段的值。
    - 使用“< 上一条”和“下一条 >”按钮在记录间切换。切换时，当前记录会自动保存。
3.  **批量填充 (可选)**:
    - 如果有多条记录的某些字段（如审批人）是相同的，可以在左侧的“批量填充工具”中输入这些值。
    - 点击“应用到后续所有记录”按钮，这些值就会被填充到从当前记录到最后的所有记录中。
4.  **导出文件**:
    - 全部数据处理完毕后，点击“导出文件”按钮。
    - 在弹出的窗口中，选择您希望保存的文件格式（如 CSV），并指定文件名和路径。
    - 程序会将处理好的数据保存到您指定的位置。

## 6. 如何修改或添加数据字段

如果未来数据格式发生变化，需要调整程序中的字段，请遵循以下步骤。这需要对 `main.py` 文件进行少量修改。

**示例：假设我们要新增一个名为“访客单位”的字段。**

1.  **更新UI字段列表**:
    - 在 `create_form_fields` 方法内部，找到 `self.ui_fields` 列表。
    - 在这个列表中您希望的位置，加入新的字段名，例如 `"访客单位*"`。
    ```python
    # main.py -> create_form_fields()
    self.ui_fields = [
        "访问形式*", "访客姓名*", "访客单位*", "手机号*", ...
    ]
    ```

2.  **更新导入逻辑**:
    - 在 `import_file` 方法内部，找到 `field_mappings` 字典。
    - 在字典中加入新字段的映射关系。键（key）是程序内部使用的标准名，值（value）是一个列表，包含了在原始文件中可能出现的列名。
    ```python
    # main.py -> import_file()
    field_mappings = {
        "访问形式": ["访问形式"],
        "访客姓名": ["访客姓名"],
        "访客单位": ["访客单位", "单位名称"], # 新增此行，可识别"访客单位"或"单位名称"
        "手机号": ["手机号"],
        ...
    }
    ```

3.  **更新导出表头**:
    - 在 `export_file` 方法内部，找到 `output_columns_with_asterisks` 列表。
    - 在您希望的位置，加入新字段在导出文件中的最终表头。
    ```python
    # main.py -> export_file()
    output_columns_with_asterisks = [
        "访问形式*", "访客姓名*", "访客单位*", "手机号*", ...
    ]
    ```

**完成以上三步后，程序就能正确处理新增的“访客单位”字段了。** 删除或修改现有字段的流程与此类似。由于程序的大部分逻辑（如UI生成、数据加载/保存）都是基于这几个列表动态构建的，因此您通常不需要修改其他代码。