# 进校申请数据处理工具

一个使用 Python 和 Tkinter 构建的桌面应用程序，用于简化和标准化进校申请表格的处理流程。

---

## ► 项目总览

本工具提供了一个简洁的图形用户界面（GUI），旨在帮助操作员高效地处理、清洗和规范来自 `.xls` 或 `.csv` 文件中格式不统一的申请数据。它支持逐条审查、修正和补充数据，并最终将处理完成的干净数据导出为多种格式。

## ✨ 核心功能

-   **智能导入**:
    -   支持导入 `.xls`, `.xlsx`, `.csv` 多种格式的文件。
    -   能够自动识别并跳过特定格式的 CSV 文件中前置的说明性文字。
    -   兼容 `UTF-8` 和 `GBK` 两种编码的 CSV 文件，避免乱码。
-   **数据预处理**:
    -   导入时自动移除字段末尾的 `#` 标记，实现无缝的二次导入和编辑。
    -   自动将车辆号码转换为大写并移除所有空格。
-   **高效UI操作**:
    -   提供“上一条”、“下一条”、“跳转”等便捷的导航控件。
    -   对“访问形式”等字段使用下拉框以规范输入。
    -   为“场所名称”提供预设复选框，并支持手动输入其他自定义场所。
-   **批量填充**:
    -   强大的批量处理工具，可将“审批人姓名”、“访问事由”等值一键应用到后续所有记录，极大提升重复数据录入效率。
-   **灵活导出**:
    -   支持将数据导出为 `.csv`, `.xlsx`, 或 `.json` 格式。
    -   导出的 CSV 文件采用 `GBK` 编码，以保证在各类办公软件中的兼容性。
    -   能自动为导出的 CSV 文件添加符合规范的12行说明头。

## 🛠️ 技术栈

-   **编程语言**: Python 3
-   **图形界面**: Tkinter
-   **数据处理**: pandas
-   **日历控件**: tkcalendar

## 🚀 环境配置与运行

本指南将引导您完成项目的本地环境搭建和启动。

### 1. 环境要求

-   [Python 3.7+](https://www.python.org/)
-   [uv](https://github.com/astral-sh/uv) (一个速度极快的 Python 包安装与管理工具)当然，这个是可选项，但是我还是建议大家使用uv

### 2. 安装与配置

1.  **克隆仓库:**
    ```bash
    git clone https://github.com/Random-Yanxh/school_admission_application_data_processing_tool.git
    ```

2.  **使用 `uv` 创建并激活虚拟环境:**
    ```bash
    # 创建一个名为 .venv 的虚拟环境
    uv venv
    
    # 激活环境
    # Windows (PowerShell/CMD):
    .venv\Scripts\activate
    # macOS/Linux:
    source .venv/bin/activate
    ```

3.  **使用 `uv` 安装依赖:**
    ```bash
    uv pip install pandas openpyxl tkcalendar
    ```

### 3. 运行程序

在激活虚拟环境后，运行主脚本：

```bash
python main.py
```

## 📖 使用指南

1.  **导入文件**: 点击 `导入文件` 按钮，加载您的 `.xls`, `.xlsx`, 或 `.csv` 数据文件。
2.  **处理数据**:
    -   程序将显示第一条记录。
    -   在右侧的“数据编辑”表单中修改或填写每个字段。
    -   使用 `上一条` 和 `下一条` 按钮进行导航。切换记录时，当前数据会自动保存。
3.  **使用批量填充 (可选)**:
    -   对于重复数据，可在左侧的“批量填充工具”中输入。
    -   点击 `应用到后续所有记录` 按钮，即可将这些值填充到后续的所有记录中。
4.  **导出文件**:
    -   处理完所有记录后，点击 `导出文件`。
    -   选择您想要的格式并保存文件。

## 🔧 如何修改或添加数据字段

如果未来数据格式有变，您可以按以下步骤修改 `main.py` 以适配新的字段。

> **示例**: 假设需要新增一个名为“访客单位”的字段。

1.  **更新UI字段列表**:
    -   在 `create_form_fields` 方法中，将新字段名添加到 `self.ui_fields` 列表中。
    ```python
    # main.py -> create_form_fields()
    self.ui_fields = [
        "访问形式*", "访客姓名*", "访客单位*", "手机号*", ...
    ]
    ```

2.  **更新导入逻辑**:
    -   在 `import_file` 方法中，将新字段添加到 `field_mappings` 字典。键是内部标准名，值是原始文件中所有可能的列名。
    ```python
    # main.py -> import_file()
    field_mappings = {
        "访客单位": ["访客单位", "单位名称"], # 新增此行
        ...
    }
    ```

3.  **更新导出表头**:
    -   在 `export_file` 方法中，将新字段的最终导出表头添加到 `output_columns_with_asterisks` 列表中。
    ```python
    # main.py -> export_file()
    output_columns_with_asterisks = [
        "访问形式*", "访客姓名*", "访客单位*", "手机号*", ...
    ]
    ```

完成这三步后，程序即可正确处理新的“访客单位”字段。