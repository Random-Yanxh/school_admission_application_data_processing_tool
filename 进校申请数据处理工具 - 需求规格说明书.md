# **进校申请数据处理工具 \- 需求规格说明书**

## **1\. 项目目标**

开发一个桌面应用程序，用于处理不规范的《进校申请》表格。此工具需能够读取原始数据，通过图形用户界面（UI）引导操作员对数据进行标准化处理、补充必要信息，并最终将规范化后的数据导出为多种可选格式（CSV, XLS, JSON）。

## **2\. 核心流程**

1. **导入文件**：用户通过 UI 选择并上传原始的 **XLS 或 CSV** 格式的《进校申请》表格。  
2. **数据预处理**：程序自动读取数据，并对已有字段进行初步的格式化尝试。  
3. **交互式处理**：  
   * 程序在 UI 界面上逐条显示申请记录。  
   * 用户通过“**上一条**”和“**下一条**”按钮进行导航。  
   * 用户在界面中修正不规范数据、填写自定义字段。  
   * 程序对用户的输入进行实时校验。  
   * 当用户点击导航按钮时，程序会校验当前记录的完整性，若有错误则弹窗提示，并阻止跳转，直到当前记录符合规范。  
4. **导出文件**：所有数据处理完成后，用户可以选择导出的文件格式（CSV, XLS, JSON），并保存到本地。

## **3\. 字段处理规则**

| 字段名称 | 来源 | 处理/校验规则 |
| :---- | :---- | :---- |
| **访问形式** | 原始数据 / UI修正 | **必填**。UI中应为下拉菜单或单选框，可选值为：“公务拜访”、“入校参观”。 |
| **访客姓名** | 原始数据 / UI修正 | **必填**。文本框，不能为空。 |
| **手机号** | 原始数据 / UI修正 | **必填**。必须为11位数字。UI界面会对非11位的号码进行**高亮或标签提示**，并**强制用户修正**后才能继续。程序在导出时自动在末尾添加 \#。 |
| **证件类型** | 原始数据 / UI修正 | **必填**。UI中应为下拉菜单或单选框，可选值为：“身份证”、“护照”。 |
| **证件号码** | 原始数据 / UI修正 | **必填**。程序在导出时自动在末尾添加 \#。 |
| **车辆号码** | 原始数据 / UI修正 | **选填**。程序自动去除所有空格，并将字母转换为大写。 |
| **审批人学工号** | UI自定义填写 | **必填**。文本框，程序在导出时自动在末尾添加 \#。 |
| **审批人姓名** | UI自定义填写 | **必填**。文本框，不能为空。 |
| **场所名称** | UI自定义填写 | **必填**。UI中应为**复选框（Checkboxes）**，提供“东区”、“西区”、“北区”、“梅山校区”四个选项。程序根据用户的勾选，在后台用 @ 自动拼接。 |
| **访问开始时间** | UI自定义填写 | **必填**。使用日期时间选择控件，格式固定为 YYYY-MM-DD HH:MM。程序在导出时自动在末尾添加 \#。 |
| **访问结束时间** | UI自定义填写 | **必填**。使用日期时间选择控件，格式固定为 YYYY-MM-DD HH:MM。程序在导出时自动在末尾添加 \#。 |
| **拜访人及事由** | UI自定义填写 | **必填**。多行文本框，不能为空。 |

## **4\. UI/UX 详细设计**

* **布局**：界面清晰地分为几个区域：文件操作区（导入/导出）、记录导航区（上一条/下一条/当前进度）、原始数据显示区、数据填写与修正区。  
* **导航**：提供“上一条”和“下一条”按钮，允许用户在记录之间自由切换和修改。同时显示当前记录的索引，如“正在处理：第 5 / 20 条”。  
* **错误提示**：当用户输入不符合规范或遗漏必填项时，相关输入框旁应出现红色星号或提示文字。在切换记录时，若当前记录未完成，则弹出明确的错误提示对话框（例如：“访客姓名不能为空”）。  
* **控件使用**：  
  * **场所名称**：使用4个独立的复选框。  
  * **访问时间**：建议使用第三方库（如 tkcalendar）来实现日历和时间选择功能，以提升用户体验。

## **5\. 输入与输出**

* **输入格式**:  
  * XLS  
  * CSV  
* **输出格式 (用户可选)**:  
  * CSV  
  * XLS  
  * JSON  
* **字段**: 两个列表中的所有字段都将包含在输出中。

## **6\. 技术方案建议**

* **核心库**: pandas 用于数据读写和处理。  
* **UI 库**: Tkinter (Python 内置)。  
* **辅助库**: tkcalendar (社区库，用于提供日历选择控件)。  
* **数据结构**: 在程序内部，建议将每一行数据处理为 Python 的字典（Dictionary），所有数据构成一个字典列表（List of Dictionaries），方便处理和转换。